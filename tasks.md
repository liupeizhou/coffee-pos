# 任务拆解 (Tasks)

## 概述

本文档将技术计划拆解为原子化任务，每个任务包含明确的验收标准。

---

## Phase 1: 基础架构 (Foundation)

### Task 1.1: 项目初始化
- **描述**: 搭建 Electron + React + TypeScript 基础项目结构
- **验收标准**:
  - [ ] 项目可运行 `npm install`
  - [ ] 开发模式 `npm run dev` 可正常启动
  - [ ] Electron 窗口可正常显示

### Task 1.2: 数据库层
- **描述**: 实现 SQLite (sql.js) 数据库初始化和基础CRUD
- **验收标准**:
  - [ ] 数据库文件创建于 Application Support 目录
  - [ ] 基础表结构正确创建
  - [ ] 可执行基础的增删改查操作

### Task 1.3: IPC通信
- **描述**: 建立主进程与渲染进程的通信桥梁
- **验收标准**:
  - [ ] preload 正确暴露 API
  - [ ] 基础产品查询可通过 IPC 调用

---

## Phase 2: 产品管理 (Product Management)

### Task 2.1: 分类管理
- **描述**: 实现产品分类的增删改查
- **验收标准**:
  - [ ] 可创建分类
  - [ ] 可编辑分类名称
  - [ ] 可删除分类（无产品关联时）
  - [ ] 分类按 sort_order 排序

### Task 2.2: 产品管理
- **描述**: 实现产品的增删改查
- **验收标准**:
  - [ ] 可创建产品（名称、价格、分类）
  - [ ] 可编辑产品信息
  - [ ] 可删除产品
  - [ ] 产品按分类展示

### Task 2.3: 产品选项
- **描述**: 实现产品规格、温度、做法选项
- **验收标准**:
  - [ ] 可设置产品规格（大/中/小）
  - [ ] 可设置温度选项（冷/热）
  - [ ] 可设置做法选项及价格调整
  - [ ] 点单时正确计算价格

---

## Phase 3: 订单系统 (Order System)

### Task 3.1: 点单功能
- **描述**: 实现购物车点单功能
- **验收标准**:
  - [ ] 可从分类选择产品加入购物车
  - [ ] 购物车显示产品、数量、单价
  - [ ] 可调整数量或删除单品
  - [ ] 可添加订单备注

### Task 3.2: 结算功能
- **描述**: 实现支付和找零计算
- **验收标准**:
  - [ ] 显示订单总金额
  - [ ] 支持多种支付方式（现金/支付宝/微信等）
  - [ ] 正确计算找零
  - [ ] 订单完成后清空购物车

### Task 3.3: 会员折扣
- **描述**: 实现会员折扣功能
- **验收标准**:
  - [ ] 可设置会员折扣百分比
  - [ ] 结算时正确应用折扣
  - [ ] 折扣金额在订单中记录

### Task 3.4: 历史订单
- **描述**: 实现历史订单查询
- **验收标准**:
  - [ ] 可查看订单列表
  - [ ] 可查看订单详情（包含订单项）
  - [ ] 按时间倒序排列

---

## Phase 4: 员工与权限 (Staff & Permissions)

### Task 4.1: 员工管理
- **描述**: 实现员工账号CRUD
- **验收标准**:
  - [ ] 可创建员工账号（工号、姓名、密码、角色）
  - [ ] 可编辑员工信息
  - [ ] 可删除员工
  - [ ] 区分管理员和普通员工角色

### Task 4.2: 登录系统
- **描述**: 实现工号密码登录
- **验收标准**:
  - [ ] 登录页面显示工号、密码输入
  - [ ] 登录成功后进入主界面
  - [ ] 登录失败显示错误提示
  - [ ] 登录界面不显示密码提示

### Task 4.3: 权限控制
- **描述**: 实现基于角色的权限控制
- **验收标准**:
  - [ ] 普通员工无法清除数据
  - [ ] 管理员可执行所有操作
  - [ ] 登出后需重新登录

---

## Phase 5: 换班系统 (Shift Management)

### Task 5.1: 上班打卡
- **描述**: 实现上班签到功能
- **验收标准**:
  - [ ] 可选择班次类型（早班/中班/晚班）
  - [ ] 可记录交接金额
  - [ ] 打卡成功后开始当班

### Task 5.2: 下班交班
- **描述**: 实现下班结算功能
- **验收标准**:
  - [ ] 显示当班期间营业额
  - [ ] 可填写实际收银金额
  - [ ] 记录交班时间
  - [ ] 交班后必须重新登录

### Task 5.3: 换班记录
- **描述**: 实现换班历史查询
- **验收标准**:
  - [ ] 显示换班记录列表
  - [ ] 显示每班次的营业额和订单数

---

## Phase 6: 报表系统 (Reports)

### Task 6.1: 每日销售
- **描述**: 实现每日销售统计
- **验收标准**:
  - [ ] 显示当日订单数
  - [ ] 显示当日营业额（小计、优惠、总计）
  - [ ] 显示支付方式分布

### Task 6.2: 产品销量
- **描述**: 实现产品销量排行
- **验收标准**:
  - [ ] 按日期范围筛选
  - [ ] 显示每个产品的销售数量、销售额
  - [ ] 按销售额倒序排列

### Task 6.3: 同比环比
- **描述**: 实现数据对比分析
- [ ] 显示昨日同期数据对比
- [ ] 显示上月同期数据对比
- [ ] 百分比变化显示（增长/下降）

### Task 6.4: Excel导出
- **描述**: 实现报表导出功能
- [ ] 可导出日报表（订单明细、产品销量）
- [ ] 可导出的月度报表（每日汇总、产品销量）
- [ ] 文件保存到本地

---

## Phase 7: 系统设置 (Settings)

### Task 7.1: 基本设置
- [ ] 可设置店铺名称
- [ ] 可设置会员折扣百分比
- [ ] 可配置支付方式

### Task 7.2: 数据管理
- [ ] 管理员可清除所有订单数据
- [ ] 清除前需要二次确认
- [ ] 清除后保留员工账号

---

## Phase 8: 构建与发布 (Build & Release)

### Task 8.1: 生产构建
- [ ] `npm run build` 成功构建
- [ ] 构建产物无报错

### Task 8.2: 打包发布
- [ ] `npm run package` 生成 DMG 安装包
- [ ] 安装包可正常安装运行

---

## 任务依赖关系

```
Task 1.1 ──┬──> Task 1.2 ──> Task 1.3
          │
          └──> Task 2.1 ──> Task 2.2 ──> Task 2.3
                              │
Task 4.1 <─ Task 4.2 <───────┘
   │
   └─> Task 4.3

Task 3.1 ──> Task 3.2 ──> Task 3.3 ──> Task 3.4

Task 5.1 ──> Task 5.2 ──> Task 5.3

Task 6.1 ──> Task 6.2 ──> Task 6.3 ──> Task 6.4

Task 7.1 ──> Task 7.2

Task 8.1 ──> Task 8.2
```

---

## 验收 Checklist

在提交每个任务前，确保满足以下条件：

- [ ] 代码编译无错误
- [ ] 功能测试通过
- [ ] 无 console.error 错误
- [ ] 日志记录正常
- [ ] 代码符合 TypeScript 规范
